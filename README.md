# Описание Playbook
  - Дополнительный Playbook с комментариями [playbook](https://github.com/Miliandra/08-02-ansible/tree/main/playbook/site_with_comments.yml)
## Что делает Playbook:
 - Устанавливаем clickhouse
 - Скачиваем дистрибутив согласно прописанным переменным в `/group_vars/clickhouse/vars.yml`
 - Из-за другого названия пакета, используем блок `rescue` и скачиваем правильный пакет
 - Производим установку пакетов с подстановкой переменных из `/group_vars/clickhouse/vars.yml`
 - Вызываем принудительно/обязательно handlers - для перезапуска `clickhouse-server`
 - Ожидаем открытия/поднятия порта `9000` для дальнейшего успешного выполнения задачи
 - Производим создание БД, в случае кода `rc` отличного от `0 - успешное выполнение` или `82 - таблица уже существует` - задача будет с ошибкой, а если `rc` будет `0` - тогда задача завершена со статусом changed
 - Производим установку `vector`
 - Скачиваем дистрибутив с подстановкой переменных из `/group_vars/vector/vars.yml`
 - Устанавливаем скаченный дистрибутив
 - Вызываем handlers - для перезапуска службы `vector`

## Переменные в playbook

Переменные, значения которых можно обновить:
| Название переменной | Значение по умолчанию | Тип | Описание |
| --- | --- | --- | --- |
| `clickhouse_version` | `22.3.3.44` | Строка | Версия ClickHouse |
| `vector_version` | `0.22.2` | Строка | Версия Vector |

